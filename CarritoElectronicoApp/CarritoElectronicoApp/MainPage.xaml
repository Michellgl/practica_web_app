<?xml version="1.0" encoding="utf-8" ?>
<ContentPage 
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="CarritoElectronicoApp.MainPage"
    BackgroundColor="#F1F5F9"
    Title="Productos Electrónicos">

    <Grid RowDefinitions="Auto,Auto,*">

        <Button Grid.Row="0"
                Text="Ver Carrito"
                Clicked="OnVerCarritoClicked"
                BackgroundColor="#1E3A8A"
                TextColor="White"
                FontAttributes="Bold"
                CornerRadius="8"
                HeightRequest="50"
                Margin="15,10"/>

        <Frame Grid.Row="1" 
               Padding="0" 
               Margin="15,0,15,10" 
               CornerRadius="8" 
               HasShadow="False"
               BorderColor="#CBD5E1">
            <Picker x:Name="PickerCategoria"
                    Title="Filtrar por categoría"
                    TitleColor="#64748B"
                    TextColor="#0F172A"
                    BackgroundColor="White"
                    SelectedIndexChanged="OnCategoriaChanged" />
        </Frame>

        <CollectionView Grid.Row="2"
                        x:Name="ListaProductos"
                        VerticalOptions="FillAndExpand">

            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical" 
                                 Span="2" 
                                 HorizontalItemSpacing="10" 
                                 VerticalItemSpacing="10"/>
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame CornerRadius="12"
                           Padding="0"
                           HasShadow="True"
                           BorderColor="Transparent"
                           BackgroundColor="White"
                           HeightRequest="280">
                        <Grid RowDefinitions="120, *, Auto" Padding="10">

                            <Image Grid.Row="0"
                                   Source="{Binding Imagen}"
                                   BackgroundColor="#E2E8F0" 
                                   Aspect="AspectFill"
                                   Margin="-10,-10,-10,0"/>

                            <VerticalStackLayout Grid.Row="1" Spacing="2" Padding="0,5,0,0">
                                <Label Text="{Binding Nombre}"
                                       FontSize="14"
                                       FontAttributes="Bold"
                                       TextColor="#0F172A"
                                       MaxLines="2"
                                       LineBreakMode="TailTruncation"/>

                                <Label Text="{Binding Descripcion}"
                                       FontSize="11"
                                       TextColor="#64748B"
                                       MaxLines="2" 
                                       LineBreakMode="TailTruncation"/>
                            </VerticalStackLayout>

                            <VerticalStackLayout Grid.Row="2" Spacing="5">
                                <Label Text="{Binding Precio, StringFormat='${0:F2}'}"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="#2563EB"
                                       HorizontalOptions="Start"/>

                                <Button Text="Agregar"
                                        BackgroundColor="#2563EB"
                                        TextColor="White"
                                        CornerRadius="8"
                                        HeightRequest="35"
                                        Padding="0"
                                        FontSize="12"
                                        Clicked="OnAgregarCarritoClicked"/>
                            </VerticalStackLayout>

                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>

            <CollectionView.Margin>
                <Thickness Left="15" Right="15" Bottom="15"/>
            </CollectionView.Margin>

        </CollectionView>
    </Grid>
</ContentPage>